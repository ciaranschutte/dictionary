{
  "schemas": {
    "sample_registration": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_specimen_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_sample_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        }
      },
      "created": {},
      "deleted": {}
    },
    "donor": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "menopause_status": {
          "description": {
            "left": "Indicate the donor's menopause status at the time of primary diagnosis. (Codelist reference: NCI CDE ID: 2434914)",
            "right": "Indicate the donor's menopause status at the time of primary diagnosis. (Reference: caDSR CDE ID 2434914)"
          },
          "restrictions": {
            "codeList": {
              "left": [
                "Indeterminate or unknown",
                "Not applicable",
                "Perimenopausal",
                "Postmenopausal",
                "Premenopausal"
              ],
              "right": [
                "Not applicable",
                "Perimenopausal",
                "Postmenopausal",
                "Premenopausal",
                "Unknown"
              ],
              "data": { "added": ["Unknown"], "deleted": ["Indeterminate or unknown"] }
            }
          }
        }
      },
      "created": {},
      "deleted": {
        "prior_malignancy": {
          "changeType": "deleted",
          "description": "Prior malignancy affecting donor.",
          "name": "prior_malignancy",
          "restrictions": { "codeList": ["Yes", "No", "Unknown"] },
          "valueType": "string",
          "meta": { "displayName": "Prior Malignancy", "examples": "C41.1, C16.9, C00.5, D46.9" }
        },
        "cancer_type_prior_malignancy": {
          "changeType": "deleted",
          "description": "The code to represent the cancer type of a prior malignancy using the WHO ICD-10 code (https://icd.who.int/browse10/2019/en) classification.",
          "name": "cancer_type_prior_malignancy",
          "restrictions": { "regex": "^[C|D][0-9]{2}(.[0-9]{1,3}[A-Z]{0,1})?$" },
          "valueType": "string",
          "meta": { "displayName": "Cancer Type Prior Malignancy" }
        },
        "age_at_prior_malignancy": {
          "changeType": "deleted",
          "description": "If donor has history of prior malignancy, indicate age at previous diagnosis, in years.",
          "name": "age_at_prior_malignancy",
          "valueType": "integer",
          "meta": { "displayName": "Age at Prior Malignancy" }
        },
        "laterality_of_prior_malignancy": {
          "changeType": "deleted",
          "description": "If donor has history of prior malignancy, indicate laterality of previous diagnosis. (Codelist reference: NCI CDE: 4122391)",
          "name": "laterality_of_prior_malignancy",
          "valueType": "string",
          "restrictions": {
            "codeList": [
              "Bilateral",
              "Left",
              "Midline",
              "Not applicable",
              "Right",
              "Unilateral",
              "Unilateral, side not specified",
              "Unknown"
            ]
          },
          "meta": { "displayName": "Laterality at Prior Malignancy" }
        }
      }
    },
    "specimen": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_specimen_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_primary_diagnosis_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "pathological_tumour_staging_system": {
          "meta": { "validationDependency": { "left": null, "right": true } },
          "restrictions": {
            "script": {
              "left": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const arrayFormatter = arr => `\\n${arr.map(entry => `- \"${entry}\"`).join('\\n')}`;\r\n    /* This is not a required field, so first ensure that it exists */\r\n    if ($field) {\r\n      /* Contingent on the naming system for tumour staging systems to remain consistent */\r\n      const stagingName = $name\r\n        .trim()\r\n        .toLowerCase()\r\n        .split('_tumour_staging_system')[0];\r\n      const requiredFields = [\r\n        `${stagingName}_m_category`,\r\n        `${stagingName}_n_category`,\r\n        `${stagingName}_t_category`,\r\n      ];\r\n      const convertedRow = Object.fromEntries(\r\n        Object.entries($row).map(([fieldName, fieldVal]) => [fieldName.toLowerCase(), fieldVal]),\r\n      );\r\n      /* Check for contigous spaces wrapped with quotes (empty strings) */\r\n      const checkforEmpty = entry => {\r\n        return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'));\r\n      };\r\n\r\n      /* search for fields with falsy values*/\r\n      const emptyFields = requiredFields.filter(\r\n        field => !convertedRow[field] || checkforEmpty(convertedRow[field]),\r\n      );\r\n\r\n      /* The fields should be provided IF and ONLY IF the AJCC regex passes */\r\n      if (/^(AJCC)\\b/i.test($field) && emptyFields.length) {\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields are required when ${$name} is set to an AJCC option: ${arrayFormatter(\r\n            emptyFields,\r\n          )}`,\r\n        };\r\n      } else if (!/^(AJCC)\\b/i.test($field) && emptyFields.length != requiredFields.length) {\r\n        const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields cannot be provided when ${$name} is not set to an AJCC option: ${arrayFormatter(\r\n            errorFields,\r\n          )}`,\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ],
              "right": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const arrayFormatter = arr => `\\n${arr.map(entry => `- \"${entry}\"`).join('\\n')}`;\r\n    const listFormatter = arr => `${arr.map(entry => `\"${entry}\"`).join(', ')}`;\r\n\r\n   \r\n   /* Contingent on the naming system for tumour staging systems to remain consistent */\r\n    const stagingName = $name\r\n      .trim()\r\n      .toLowerCase()\r\n      .split('_tumour_staging_system')[0];\r\n    const requiredFields = [\r\n      `${stagingName}_m_category`,\r\n      `${stagingName}_n_category`,\r\n      `${stagingName}_t_category`,\r\n    ];\r\n    const convertedRow = Object.fromEntries(\r\n      Object.entries($row).map(([fieldName, fieldVal]) => [fieldName.toLowerCase(), fieldVal]),\r\n    );\r\n    /* Check for contigous spaces wrapped with quotes (empty strings) */\r\n    const checkforEmpty = entry => {\r\n      return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'));\r\n    };\r\n\r\n    /* search for fields with falsy values*/\r\n    const emptyFields = requiredFields.filter(\r\n      field => !convertedRow[field] || checkforEmpty(convertedRow[field]),\r\n    );\r\n\r\n    /* The staging system should be set to an AJCC option if the TNM fields are submitted */\r\n    if (!($field) && emptyFields.length != requiredFields.length) {\r\n       const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n       result = {\r\n         valid: false,\r\n         message:`The ${stagingName}_tumour_staging_system field must be set to an AJCC option when the following fields are submitted: ${listFormatter(\r\n            errorFields,\r\n          )}`,\r\n       };\r\n    }\r\n    /* This is not a required field, so first ensure that it exists */\r\n    else if ($field) {\r\n      /* The fields should be provided IF and ONLY IF the AJCC regex passes */\r\n      if (/^(AJCC)\\b/i.test($field) && emptyFields.length) {\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields are required when ${$name} is set to an AJCC option: ${arrayFormatter(\r\n            emptyFields,\r\n          )}`,\r\n        };\r\n      } else if (!/^(AJCC)\\b/i.test($field) && emptyFields.length != requiredFields.length) {\r\n        const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields cannot be provided when ${$name} is not set to an AJCC option: ${arrayFormatter(\r\n            errorFields,\r\n          )}`,\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ]
            }
          }
        },
        "pathological_stage_group": {
          "restrictions": {
            "script": {
              "left": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    if ($row.pathological_tumour_staging_system && $field) {\r\n      let codeList = [];\r\n      switch ($row.pathological_tumour_staging_system && $row.pathological_tumour_staging_system.trim().toLowerCase()) {\r\n        case 'revised international staging system (riss)':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii'\r\n          ];\r\n          break;\r\n        case 'lugano staging system':\r\n          codeList = [\r\n             'stage i',\r\n             'stage ia',\r\n             'stage ib',\r\n             'stage ie',\r\n             'stage iea',\r\n             'stage ieb',\r\n             'stage ii',\r\n             'stage iia',\r\n             'stage iib',\r\n             'stage iie',\r\n             'stage iiea',\r\n             'stage iieb',\r\n             'stage iii',\r\n             'stage iiia',\r\n             'stage iiib',\r\n             'stage iv',\r\n             'stage iva',\r\n             'stage ivb'\r\n          ];\r\n          break;\r\n        case 'st jude staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii',\r\n            'stage iv'\r\n          ];\r\n          break;\r\n        case 'ann arbor staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ia',\r\n            'stage ib',\r\n            'stage ie',\r\n            'stage is',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iie',\r\n            'stage iis',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iiie',\r\n            'stage iiis',\r\n            'stage iv',\r\n            'stage iva',\r\n            'stage ivb',\r\n            'stage ive',\r\n            'stage ivs'\r\n          ];\r\n          break;\r\n        case 'rai staging system':\r\n          codeList = [\r\n             'stage 0',\r\n             'stage i',\r\n             'stage ii',\r\n             'stage iii',\r\n             'stage iv'\r\n          ];\r\n          break;\r\n        case 'durie-salmon staging system':\r\n          codeList = [\r\n            'stage 1',\r\n            'stage 1a',\r\n            'stage 1b',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib'\r\n          ];\r\n          break;\r\n        case 'figo staging system':\r\n          codeList = [\r\n            'stage ia',\r\n            'stage ia1',\r\n            'stage ia2',\r\n            'stage ib',\r\n            'stage ib1',\r\n            'stage ib2',\r\n            'stage iia',\r\n            'stage iab',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iva',\r\n            'stage ivb'\r\n          ];\r\n          break;\r\n        case 'binet staging system':\r\n          codeList = [\r\n             'stage a',\r\n             'stage b',\r\n             'stage c'\r\n         ];\r\n          break;\r\n        case 'ajcc 8th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ia3','stage ib','stage ib1','stage ib2','stage ic','stage ie','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iie','stage iii','stage iiia','stage iiia1','stage iiia2','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iiid','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'];\r\n          break;\r\n        case 'ajcc 7th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ib','stage ib1','stage ib2','stage ic','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iii','stage iiia','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'\r\n];\r\n          break;\r\n        default:\r\n          codelist = [];\r\n      }\r\n\r\n      if (!codeList.includes($field.trim().toLowerCase()) && codeList.length) {\r\n        const msg = `'${$field}' is not a permissible value. When 'pathological_tumour_staging_system' is set to '${\r\n          $row.pathological_tumour_staging_system\r\n        }', 'pathological_stage_group' must be one of the following: \\n${codeList\r\n          .map(code => `- \"${code}\"`)\r\n          .join('\\n')}`;\r\n\r\n        result.valid = false;\r\n        result.message = msg;\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ],
              "right": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const stagingName = $name\r\n      .trim()\r\n      .toLowerCase()\r\n      .split('_stage_group')[0];\r\n\r\n    const stagingSystem = stagingName + `_tumour_staging_system`;\r\n    \r\n    // checks for a string just consisting of whitespace\r\n    const checkforEmpty = (entry) => {return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'))};\r\n \r\n    if ($row[stagingSystem] && (!$field || checkforEmpty($field))) {\r\n      result.valid = false;\r\n      const msg = `The ${stagingName}_stage_group must be submitted if the field ${stagingSystem} is submitted.`;\r\n      result.message = msg;\r\n    }\r\n    else if (!($row[stagingSystem]) && $field) {\r\n       result.valid = false;\r\n       const msg = `The field ${stagingSystem} must be submitted if ${stagingName}_stage_group is submitted.`;\r\n       result.message = msg;\r\n    }\r\n    else if ($row[stagingSystem] && $field) {\r\n      let codeList = [];\r\n      switch ($row[stagingSystem] && $row[stagingSystem].trim().toLowerCase()) {\r\n        case 'revised international staging system (riss)':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii'\r\n          ];\r\n          break;\r\n        case 'lugano staging system':\r\n          codeList = [\r\n             'stage i',\r\n             'stage ia',\r\n             'stage ib',\r\n             'stage ie',\r\n             'stage iea',\r\n             'stage ieb',\r\n             'stage ii',\r\n             'stage iia',\r\n             'stage iib',\r\n             'stage iie',\r\n             'stage iiea',\r\n             'stage iieb',\r\n             'stage iii',\r\n             'stage iiia',\r\n             'stage iiib',\r\n             'stage iv',\r\n             'stage iva',\r\n             'stage ivb'\r\n          ];\r\n          break;\r\n        case 'st jude staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii',\r\n            'stage iv'\r\n          ];\r\n          break;\r\n        case 'ann arbor staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ia',\r\n            'stage ib',\r\n            'stage ie',\r\n            'stage is',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iie',\r\n            'stage iis',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iiie',\r\n            'stage iiis',\r\n            'stage iv',\r\n            'stage iva',\r\n            'stage ivb',\r\n            'stage ive',\r\n            'stage ivs'\r\n          ];\r\n          break;\r\n        case 'rai staging system':\r\n          codeList = [\r\n             'stage 0',\r\n             'stage i',\r\n             'stage ii',\r\n             'stage iii',\r\n             'stage iv'\r\n          ];\r\n          break;\r\n        case 'durie-salmon staging system':\r\n          codeList = [\r\n            'stage 1',\r\n            'stage 1a',\r\n            'stage 1b',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib'\r\n          ];\r\n          break;\r\n        case 'figo staging system':\r\n          codeList = [\r\n            'stage ia',\r\n            'stage ia1',\r\n            'stage ia2',\r\n            'stage ib',\r\n            'stage ib1',\r\n            'stage ib2',\r\n            'stage iia',\r\n            'stage iab',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iva',\r\n            'stage ivb'\r\n          ];\r\n          break;\r\n        case 'binet staging system':\r\n          codeList = [\r\n             'stage a',\r\n             'stage b',\r\n             'stage c'\r\n         ];\r\n          break;\r\n        case 'ajcc 8th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ia3','stage ib','stage ib1','stage ib2','stage ic','stage ie','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iie','stage iii','stage iiia','stage iiia1','stage iiia2','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iiid','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'];\r\n          break;\r\n        case 'ajcc 7th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ib','stage ib1','stage ib2','stage ic','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iii','stage iiia','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'\r\n];\r\n          break;\r\n        default:\r\n          codelist = [];\r\n      }\r\n\r\n      if (!codeList.includes($field.trim().toLowerCase()) && codeList.length) {\r\n        const msg = `'${$field}' is not a permissible value. When '${stagingSystem}' is set to '${\r\n          $row[stagingSystem]\r\n        }', '${stagingName}_stage_group' must be one of the following: \\n${codeList\r\n          .map(code => `- \"${code}\"`)\r\n          .join('\\n')}`;\r\n\r\n        result.valid = false;\r\n        result.message = msg;\r\n      }\r\n    }\r\n    \r\n    return result;\r\n  })"
              ]
            }
          }
        }
      },
      "created": {},
      "deleted": {}
    },
    "primary_diagnosis": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_primary_diagnosis_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "number_lymph_nodes_positive": {
          "description": {
            "left": "The number of regional lymph nodes reported as being positive for tumour metastases. (Reference: NCI CDE ID: 6113694)",
            "right": "The number of regional lymph nodes reported as being positive for tumour metastases. (Reference: caDSR CDE ID 6113694)"
          }
        },
        "number_lymph_nodes_examined": {
          "description": {
            "left": "The total number of lymph nodes tested for the presence of cancer. (Reference: NCI CDE ID: 3)",
            "right": "The total number of lymph nodes tested for the presence of cancer. (Reference: caDSR CDE ID 3)"
          }
        },
        "clinical_tumour_staging_system": {
          "meta": { "validationDependency": { "left": null, "right": true } },
          "restrictions": {
            "script": {
              "left": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const arrayFormatter = arr => `\\n${arr.map(entry => `- \"${entry}\"`).join('\\n')}`;\r\n    /* This is not a required field, so first ensure that it exists */\r\n    if ($field) {\r\n      /* Contingent on the naming system for tumour staging systems to remain consistent */\r\n      const stagingName = $name\r\n        .trim()\r\n        .toLowerCase()\r\n        .split('_tumour_staging_system')[0];\r\n      const requiredFields = [\r\n        `${stagingName}_m_category`,\r\n        `${stagingName}_n_category`,\r\n        `${stagingName}_t_category`,\r\n      ];\r\n      const convertedRow = Object.fromEntries(\r\n        Object.entries($row).map(([fieldName, fieldVal]) => [fieldName.toLowerCase(), fieldVal]),\r\n      );\r\n      /* Check for contigous spaces wrapped with quotes (empty strings) */\r\n      const checkforEmpty = entry => {\r\n        return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'));\r\n      };\r\n\r\n      /* search for fields with falsy values*/\r\n      const emptyFields = requiredFields.filter(\r\n        field => !convertedRow[field] || checkforEmpty(convertedRow[field]),\r\n      );\r\n\r\n      /* The fields should be provided IF and ONLY IF the AJCC regex passes */\r\n      if (/^(AJCC)\\b/i.test($field) && emptyFields.length) {\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields are required when ${$name} is set to an AJCC option: ${arrayFormatter(\r\n            emptyFields,\r\n          )}`,\r\n        };\r\n      } else if (!/^(AJCC)\\b/i.test($field) && emptyFields.length != requiredFields.length) {\r\n        const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields cannot be provided when ${$name} is not set to an AJCC option: ${arrayFormatter(\r\n            errorFields,\r\n          )}`,\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ],
              "right": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const arrayFormatter = arr => `\\n${arr.map(entry => `- \"${entry}\"`).join('\\n')}`;\r\n    const listFormatter = arr => `${arr.map(entry => `\"${entry}\"`).join(', ')}`;\r\n\r\n   \r\n   /* Contingent on the naming system for tumour staging systems to remain consistent */\r\n    const stagingName = $name\r\n      .trim()\r\n      .toLowerCase()\r\n      .split('_tumour_staging_system')[0];\r\n    const requiredFields = [\r\n      `${stagingName}_m_category`,\r\n      `${stagingName}_n_category`,\r\n      `${stagingName}_t_category`,\r\n    ];\r\n    const convertedRow = Object.fromEntries(\r\n      Object.entries($row).map(([fieldName, fieldVal]) => [fieldName.toLowerCase(), fieldVal]),\r\n    );\r\n    /* Check for contigous spaces wrapped with quotes (empty strings) */\r\n    const checkforEmpty = entry => {\r\n      return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'));\r\n    };\r\n\r\n    /* search for fields with falsy values*/\r\n    const emptyFields = requiredFields.filter(\r\n      field => !convertedRow[field] || checkforEmpty(convertedRow[field]),\r\n    );\r\n\r\n    /* The staging system should be set to an AJCC option if the TNM fields are submitted */\r\n    if (!($field) && emptyFields.length != requiredFields.length) {\r\n       const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n       result = {\r\n         valid: false,\r\n         message:`The ${stagingName}_tumour_staging_system field must be set to an AJCC option when the following fields are submitted: ${listFormatter(\r\n            errorFields,\r\n          )}`,\r\n       };\r\n    }\r\n    /* This is not a required field, so first ensure that it exists */\r\n    else if ($field) {\r\n      /* The fields should be provided IF and ONLY IF the AJCC regex passes */\r\n      if (/^(AJCC)\\b/i.test($field) && emptyFields.length) {\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields are required when ${$name} is set to an AJCC option: ${arrayFormatter(\r\n            emptyFields,\r\n          )}`,\r\n        };\r\n      } else if (!/^(AJCC)\\b/i.test($field) && emptyFields.length != requiredFields.length) {\r\n        const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields cannot be provided when ${$name} is not set to an AJCC option: ${arrayFormatter(\r\n            errorFields,\r\n          )}`,\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ]
            },
            "required": { "left": true, "right": null }
          }
        },
        "clinical_stage_group": {
          "restrictions": {
            "required": { "left": true, "right": null },
            "script": {
              "left": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    if ($row.clinical_tumour_staging_system && $field) {\r\n      let codeList = [];\r\n      switch ($row.clinical_tumour_staging_system && $row.clinical_tumour_staging_system.trim().toLowerCase()) {\r\n        case 'revised international staging system (riss)':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii'\r\n          ];\r\n          break;\r\n        case 'lugano staging system':\r\n          codeList = [\r\n             'stage i',\r\n             'stage ia',\r\n             'stage ib',\r\n             'stage ie',\r\n             'stage iea',\r\n             'stage ieb',\r\n             'stage ii',\r\n             'stage iia',\r\n             'stage iib',\r\n             'stage iie',\r\n             'stage iiea',\r\n             'stage iieb',\r\n             'stage iii',\r\n             'stage iiia',\r\n             'stage iiib',\r\n             'stage iv',\r\n             'stage iva',\r\n             'stage ivb'\r\n          ];\r\n          break;\r\n        case 'st jude staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii',\r\n            'stage iv'\r\n          ];\r\n          break;\r\n        case 'ann arbor staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ia',\r\n            'stage ib',\r\n            'stage ie',\r\n            'stage is',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iie',\r\n            'stage iis',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iiie',\r\n            'stage iiis',\r\n            'stage iv',\r\n            'stage iva',\r\n            'stage ivb',\r\n            'stage ive',\r\n            'stage ivs'\r\n          ];\r\n          break;\r\n        case 'rai staging system':\r\n          codeList = [\r\n             'stage 0',\r\n             'stage i',\r\n             'stage ii',\r\n             'stage iii',\r\n             'stage iv'\r\n          ];\r\n          break;\r\n        case 'durie-salmon staging system':\r\n          codeList = [\r\n            'stage 1',\r\n            'stage 1a',\r\n            'stage 1b',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib'\r\n          ];\r\n          break;\r\n        case 'figo staging system':\r\n          codeList = [\r\n            'stage ia',\r\n            'stage ia1',\r\n            'stage ia2',\r\n            'stage ib',\r\n            'stage ib1',\r\n            'stage ib2',\r\n            'stage iia',\r\n            'stage iab',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iva',\r\n            'stage ivb'\r\n          ];\r\n          break;\r\n        case 'binet staging system':\r\n          codeList = [\r\n             'stage a',\r\n             'stage b',\r\n             'stage c'\r\n         ];\r\n          break;\r\n        case 'ajcc 8th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ia3','stage ib','stage ib1','stage ib2','stage ic','stage ie','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iie','stage iii','stage iiia','stage iiia1','stage iiia2','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iiid','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'];\r\n          break;\r\n        case 'ajcc 7th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ib','stage ib1','stage ib2','stage ic','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iii','stage iiia','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'\r\n];\r\n          break;\r\n        default:\r\n          codelist = [];\r\n      }\r\n\r\n      if (!codeList.includes($field.trim().toLowerCase()) && codeList.length) {\r\n        const msg = `'${$field}' is not a permissible value. When 'clinical_tumour_staging_system' is set to '${\r\n          $row.clinical_tumour_staging_system\r\n        }', 'clinical_stage_group' must be one of the following: \\n${codeList\r\n          .map(code => `- \"${code}\"`)\r\n          .join('\\n')}`;\r\n\r\n        result.valid = false;\r\n        result.message = msg;\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ],
              "right": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const stagingName = $name\r\n      .trim()\r\n      .toLowerCase()\r\n      .split('_stage_group')[0];\r\n\r\n    const stagingSystem = stagingName + `_tumour_staging_system`;\r\n    \r\n    // checks for a string just consisting of whitespace\r\n    const checkforEmpty = (entry) => {return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'))};\r\n \r\n    if ($row[stagingSystem] && (!$field || checkforEmpty($field))) {\r\n      result.valid = false;\r\n      const msg = `The ${stagingName}_stage_group must be submitted if the field ${stagingSystem} is submitted.`;\r\n      result.message = msg;\r\n    }\r\n    else if (!($row[stagingSystem]) && $field) {\r\n       result.valid = false;\r\n       const msg = `The field ${stagingSystem} must be submitted if ${stagingName}_stage_group is submitted.`;\r\n       result.message = msg;\r\n    }\r\n    else if ($row[stagingSystem] && $field) {\r\n      let codeList = [];\r\n      switch ($row[stagingSystem] && $row[stagingSystem].trim().toLowerCase()) {\r\n        case 'revised international staging system (riss)':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii'\r\n          ];\r\n          break;\r\n        case 'lugano staging system':\r\n          codeList = [\r\n             'stage i',\r\n             'stage ia',\r\n             'stage ib',\r\n             'stage ie',\r\n             'stage iea',\r\n             'stage ieb',\r\n             'stage ii',\r\n             'stage iia',\r\n             'stage iib',\r\n             'stage iie',\r\n             'stage iiea',\r\n             'stage iieb',\r\n             'stage iii',\r\n             'stage iiia',\r\n             'stage iiib',\r\n             'stage iv',\r\n             'stage iva',\r\n             'stage ivb'\r\n          ];\r\n          break;\r\n        case 'st jude staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii',\r\n            'stage iv'\r\n          ];\r\n          break;\r\n        case 'ann arbor staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ia',\r\n            'stage ib',\r\n            'stage ie',\r\n            'stage is',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iie',\r\n            'stage iis',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iiie',\r\n            'stage iiis',\r\n            'stage iv',\r\n            'stage iva',\r\n            'stage ivb',\r\n            'stage ive',\r\n            'stage ivs'\r\n          ];\r\n          break;\r\n        case 'rai staging system':\r\n          codeList = [\r\n             'stage 0',\r\n             'stage i',\r\n             'stage ii',\r\n             'stage iii',\r\n             'stage iv'\r\n          ];\r\n          break;\r\n        case 'durie-salmon staging system':\r\n          codeList = [\r\n            'stage 1',\r\n            'stage 1a',\r\n            'stage 1b',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib'\r\n          ];\r\n          break;\r\n        case 'figo staging system':\r\n          codeList = [\r\n            'stage ia',\r\n            'stage ia1',\r\n            'stage ia2',\r\n            'stage ib',\r\n            'stage ib1',\r\n            'stage ib2',\r\n            'stage iia',\r\n            'stage iab',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iva',\r\n            'stage ivb'\r\n          ];\r\n          break;\r\n        case 'binet staging system':\r\n          codeList = [\r\n             'stage a',\r\n             'stage b',\r\n             'stage c'\r\n         ];\r\n          break;\r\n        case 'ajcc 8th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ia3','stage ib','stage ib1','stage ib2','stage ic','stage ie','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iie','stage iii','stage iiia','stage iiia1','stage iiia2','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iiid','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'];\r\n          break;\r\n        case 'ajcc 7th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ib','stage ib1','stage ib2','stage ic','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iii','stage iiia','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'\r\n];\r\n          break;\r\n        default:\r\n          codelist = [];\r\n      }\r\n\r\n      if (!codeList.includes($field.trim().toLowerCase()) && codeList.length) {\r\n        const msg = `'${$field}' is not a permissible value. When '${stagingSystem}' is set to '${\r\n          $row[stagingSystem]\r\n        }', '${stagingName}_stage_group' must be one of the following: \\n${codeList\r\n          .map(code => `- \"${code}\"`)\r\n          .join('\\n')}`;\r\n\r\n        result.valid = false;\r\n        result.message = msg;\r\n      }\r\n    }\r\n    \r\n    return result;\r\n  })"
              ]
            }
          }
        },
        "performance_status": {
          "description": {
            "left": "Indicate the donor's performance status grade at the time of primary diagnosis. (Reference source: ECOG performance score grades from https://ecog-acrin.org/resources/ecog-performance-status).",
            "right": "Indicate the donor's performance status grade at the time of primary diagnosis. (Reference: ECOG performance score grades from https://ecog-acrin.org/resources/ecog-performance-status)."
          }
        }
      },
      "created": {},
      "deleted": {}
    },
    "treatment": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_treatment_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_primary_diagnosis_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "treatment_intent": {
          "description": {
            "left": "Indicate the intended disease outcome for which the treatment is given. (Reference: CDISC [NCIt code: C124307])",
            "right": "Indicate the intended disease outcome for which the treatment is given. (Reference: NCIt C124307)"
          }
        },
        "treatment_setting": {
          "description": {
            "left": "Indicate the treatment setting, which describes the treatment's purpose in relation to the primary treatment. (Reference: CDISC [NCIt code: C124308])",
            "right": "Indicate the treatment setting, which describes the treatment's purpose in relation to the primary treatment. (Reference: NCIt C124308)"
          }
        }
      },
      "created": {},
      "deleted": {
        "age_at_consent_for_treatment": {
          "changeType": "deleted",
          "name": "age_at_consent_for_treatment",
          "description": "Indicate the age of donor when consent was given for treatment.",
          "valueType": "integer",
          "meta": { "displayName": "Age At Consent For Treatment" }
        }
      }
    },
    "chemotherapy": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_treatment_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        }
      },
      "created": {},
      "deleted": {}
    },
    "hormone_therapy": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_treatment_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        }
      },
      "created": {},
      "deleted": {}
    },
    "radiation": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_treatment_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        }
      },
      "created": {},
      "deleted": {}
    },
    "follow_up": {
      "updated": {
        "submitter_donor_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_follow_up_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_primary_diagnosis_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "submitter_treatment_id": {
          "meta": {
            "notes": {
              "left": "To prevent data collisions, submitter_id cannot begin with any of the ARGO ID prefixes.  The restricted prefixes include: `DO`, `SP`, `SA`,`TR`,`FU`, `PD`.",
              "right": null
            }
          }
        },
        "method_of_progression_status": {
          "description": {
            "left": "Indicate the method(s) used to confirm the donor's progression or relapse or recurrence disease status. (Codelist reference: NCI CDE ID: 6161031)",
            "right": "Indicate the method(s) used to confirm the donor's progression or relapse or recurrence disease status. (Reference: caDSR CDE ID 6161031)"
          }
        },
        "recurrence_tumour_staging_system": {
          "restrictions": {
            "script": {
              "left": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const arrayFormatter = arr => `\\n${arr.map(entry => `- \"${entry}\"`).join('\\n')}`;\r\n    /* This is not a required field, so first ensure that it exists */\r\n    if ($field) {\r\n      /* Contingent on the naming system for tumour staging systems to remain consistent */\r\n      const stagingName = $name\r\n        .trim()\r\n        .toLowerCase()\r\n        .split('_tumour_staging_system')[0];\r\n      const requiredFields = [\r\n        `${stagingName}_m_category`,\r\n        `${stagingName}_n_category`,\r\n        `${stagingName}_t_category`,\r\n      ];\r\n      const convertedRow = Object.fromEntries(\r\n        Object.entries($row).map(([fieldName, fieldVal]) => [fieldName.toLowerCase(), fieldVal]),\r\n      );\r\n      /* Check for contigous spaces wrapped with quotes (empty strings) */\r\n      const checkforEmpty = entry => {\r\n        return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'));\r\n      };\r\n\r\n      /* search for fields with falsy values*/\r\n      const emptyFields = requiredFields.filter(\r\n        field => !convertedRow[field] || checkforEmpty(convertedRow[field]),\r\n      );\r\n\r\n      /* The fields should be provided IF and ONLY IF the AJCC regex passes */\r\n      if (/^(AJCC)\\b/i.test($field) && emptyFields.length) {\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields are required when ${$name} is set to an AJCC option: ${arrayFormatter(\r\n            emptyFields,\r\n          )}`,\r\n        };\r\n      } else if (!/^(AJCC)\\b/i.test($field) && emptyFields.length != requiredFields.length) {\r\n        const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields cannot be provided when ${$name} is not set to an AJCC option: ${arrayFormatter(\r\n            errorFields,\r\n          )}`,\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  })",
                "(function validate(inputs) {\r\n      const {$row, $name, $field} = inputs;\r\n        let result = {valid: true, message: \"Ok\"};\r\n        \r\n        /* required field, cannot be null */\r\n        const diseaseStatus = $row.disease_status_at_followup.trim().toLowerCase();\r\n    \r\n        const stateOfProgression = (entry) => {return /(progression)$/.test(decodeURI(entry))}; \r\n        const relapseOrRecurrence = diseaseStatus === \"relapse or recurrence\";\r\n   \r\n        // checks for a string just consisting of whitespace\r\n        const checkforEmpty = (entry) => {return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'))};\r\n\r\n\r\n        if ((!$field || checkforEmpty($field)) && (stateOfProgression(diseaseStatus) || relapseOrRecurrence)) {\r\n            result = {valid: false, message: `'${$name}' is a required field if 'disease_status_at_followup' is set a state of progression, relapse, or recurrence.` }\r\n        }\r\n        else if (!(!$field || checkforEmpty($field)) && !stateOfProgression(diseaseStatus) && !relapseOrRecurrence) {\r\n            result = {valid: false, message: `'${$name}' cannot be provided if 'disease_status_at_followup' is not a state of progression, relapse, or recurrence.` }\r\n        }\r\n        return  result;\r\n    })"
              ],
              "right": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const arrayFormatter = arr => `\\n${arr.map(entry => `- \"${entry}\"`).join('\\n')}`;\r\n    const listFormatter = arr => `${arr.map(entry => `\"${entry}\"`).join(', ')}`;\r\n\r\n   \r\n   /* Contingent on the naming system for tumour staging systems to remain consistent */\r\n    const stagingName = $name\r\n      .trim()\r\n      .toLowerCase()\r\n      .split('_tumour_staging_system')[0];\r\n    const requiredFields = [\r\n      `${stagingName}_m_category`,\r\n      `${stagingName}_n_category`,\r\n      `${stagingName}_t_category`,\r\n    ];\r\n    const convertedRow = Object.fromEntries(\r\n      Object.entries($row).map(([fieldName, fieldVal]) => [fieldName.toLowerCase(), fieldVal]),\r\n    );\r\n    /* Check for contigous spaces wrapped with quotes (empty strings) */\r\n    const checkforEmpty = entry => {\r\n      return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'));\r\n    };\r\n\r\n    /* search for fields with falsy values*/\r\n    const emptyFields = requiredFields.filter(\r\n      field => !convertedRow[field] || checkforEmpty(convertedRow[field]),\r\n    );\r\n\r\n    /* The staging system should be set to an AJCC option if the TNM fields are submitted */\r\n    if (!($field) && emptyFields.length != requiredFields.length) {\r\n       const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n       result = {\r\n         valid: false,\r\n         message:`The ${stagingName}_tumour_staging_system field must be set to an AJCC option when the following fields are submitted: ${listFormatter(\r\n            errorFields,\r\n          )}`,\r\n       };\r\n    }\r\n    /* This is not a required field, so first ensure that it exists */\r\n    else if ($field) {\r\n      /* The fields should be provided IF and ONLY IF the AJCC regex passes */\r\n      if (/^(AJCC)\\b/i.test($field) && emptyFields.length) {\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields are required when ${$name} is set to an AJCC option: ${arrayFormatter(\r\n            emptyFields,\r\n          )}`,\r\n        };\r\n      } else if (!/^(AJCC)\\b/i.test($field) && emptyFields.length != requiredFields.length) {\r\n        const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields cannot be provided when ${$name} is not set to an AJCC option: ${arrayFormatter(\r\n            errorFields,\r\n          )}`,\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  })",
                "(function validate(inputs) {\r\n      const {$row, $name, $field} = inputs;\r\n        let result = {valid: true, message: \"Ok\"};\r\n        \r\n        /* required field, cannot be null */\r\n        const diseaseStatus = $row.disease_status_at_followup.trim().toLowerCase();\r\n    \r\n        const stateOfProgression = (entry) => {return /(progression)$/.test(decodeURI(entry))}; \r\n        const relapseOrRecurrence = diseaseStatus === \"relapse or recurrence\";\r\n   \r\n        // checks for a string just consisting of whitespace\r\n        const checkforEmpty = (entry) => {return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'))};\r\n\r\n\r\n        if ((!$field || checkforEmpty($field)) && (stateOfProgression(diseaseStatus) || relapseOrRecurrence)) {\r\n            result = {valid: false, message: `'${$name}' is a required field if 'disease_status_at_followup' is set a state of progression, relapse, or recurrence.` }\r\n        }\r\n        else if (!(!$field || checkforEmpty($field)) && !stateOfProgression(diseaseStatus) && !relapseOrRecurrence) {\r\n            result = {valid: false, message: `'${$name}' cannot be provided if 'disease_status_at_followup' is not a state of progression, relapse, or recurrence.` }\r\n        }\r\n        return  result;\r\n    })"
              ]
            }
          }
        },
        "recurrence_stage_group": {
          "restrictions": {
            "script": {
              "left": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    if ($row.recurrence_tumour_staging_system && $field) {\r\n      let codeList = [];\r\n      switch ($row.recurrence_tumour_staging_system && $row.recurrence_tumour_staging_system.trim().toLowerCase()) {\r\n        case 'revised international staging system (riss)':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii'\r\n          ];\r\n          break;\r\n        case 'lugano staging system':\r\n          codeList = [\r\n             'stage i',\r\n             'stage ia',\r\n             'stage ib',\r\n             'stage ie',\r\n             'stage iea',\r\n             'stage ieb',\r\n             'stage ii',\r\n             'stage iia',\r\n             'stage iib',\r\n             'stage iie',\r\n             'stage iiea',\r\n             'stage iieb',\r\n             'stage iii',\r\n             'stage iiia',\r\n             'stage iiib',\r\n             'stage iv',\r\n             'stage iva',\r\n             'stage ivb'\r\n          ];\r\n          break;\r\n        case 'st jude staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii',\r\n            'stage iv'\r\n          ];\r\n          break;\r\n        case 'ann arbor staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ia',\r\n            'stage ib',\r\n            'stage ie',\r\n            'stage is',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iie',\r\n            'stage iis',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iiie',\r\n            'stage iiis',\r\n            'stage iv',\r\n            'stage iva',\r\n            'stage ivb',\r\n            'stage ive',\r\n            'stage ivs'\r\n          ];\r\n          break;\r\n        case 'rai staging system':\r\n          codeList = [\r\n             'stage 0',\r\n             'stage i',\r\n             'stage ii',\r\n             'stage iii',\r\n             'stage iv'\r\n          ];\r\n          break;\r\n        case 'durie-salmon staging system':\r\n          codeList = [\r\n            'stage 1',\r\n            'stage 1a',\r\n            'stage 1b',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib'\r\n          ];\r\n          break;\r\n        case 'figo staging system':\r\n          codeList = [\r\n            'stage ia',\r\n            'stage ia1',\r\n            'stage ia2',\r\n            'stage ib',\r\n            'stage ib1',\r\n            'stage ib2',\r\n            'stage iia',\r\n            'stage iab',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iva',\r\n            'stage ivb'\r\n          ];\r\n          break;\r\n        case 'binet staging system':\r\n          codeList = [\r\n             'stage a',\r\n             'stage b',\r\n             'stage c'\r\n         ];\r\n          break;\r\n        case 'ajcc 8th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ia3','stage ib','stage ib1','stage ib2','stage ic','stage ie','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iie','stage iii','stage iiia','stage iiia1','stage iiia2','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iiid','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'];\r\n          break;\r\n        case 'ajcc 7th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ib','stage ib1','stage ib2','stage ic','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iii','stage iiia','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'\r\n];\r\n          break;\r\n        default:\r\n          codelist = [];\r\n      }\r\n\r\n      if (!codeList.includes($field.trim().toLowerCase()) && codeList.length) {\r\n        const msg = `'${$field}' is not a permissible value. When 'recurrence_tumour_staging_system' is set to '${\r\n          $row.recurrence_tumour_staging_system\r\n        }', 'recurrence_stage_group' must be one of the following: \\n${codeList\r\n          .map(code => `- \"${code}\"`)\r\n          .join('\\n')}`;\r\n\r\n        result.valid = false;\r\n        result.message = msg;\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ],
              "right": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const stagingName = $name\r\n      .trim()\r\n      .toLowerCase()\r\n      .split('_stage_group')[0];\r\n\r\n    const stagingSystem = stagingName + `_tumour_staging_system`;\r\n    \r\n    // checks for a string just consisting of whitespace\r\n    const checkforEmpty = (entry) => {return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'))};\r\n \r\n    if ($row[stagingSystem] && (!$field || checkforEmpty($field))) {\r\n      result.valid = false;\r\n      const msg = `The ${stagingName}_stage_group must be submitted if the field ${stagingSystem} is submitted.`;\r\n      result.message = msg;\r\n    }\r\n    else if (!($row[stagingSystem]) && $field) {\r\n       result.valid = false;\r\n       const msg = `The field ${stagingSystem} must be submitted if ${stagingName}_stage_group is submitted.`;\r\n       result.message = msg;\r\n    }\r\n    else if ($row[stagingSystem] && $field) {\r\n      let codeList = [];\r\n      switch ($row[stagingSystem] && $row[stagingSystem].trim().toLowerCase()) {\r\n        case 'revised international staging system (riss)':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii'\r\n          ];\r\n          break;\r\n        case 'lugano staging system':\r\n          codeList = [\r\n             'stage i',\r\n             'stage ia',\r\n             'stage ib',\r\n             'stage ie',\r\n             'stage iea',\r\n             'stage ieb',\r\n             'stage ii',\r\n             'stage iia',\r\n             'stage iib',\r\n             'stage iie',\r\n             'stage iiea',\r\n             'stage iieb',\r\n             'stage iii',\r\n             'stage iiia',\r\n             'stage iiib',\r\n             'stage iv',\r\n             'stage iva',\r\n             'stage ivb'\r\n          ];\r\n          break;\r\n        case 'st jude staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii',\r\n            'stage iv'\r\n          ];\r\n          break;\r\n        case 'ann arbor staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ia',\r\n            'stage ib',\r\n            'stage ie',\r\n            'stage is',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iie',\r\n            'stage iis',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iiie',\r\n            'stage iiis',\r\n            'stage iv',\r\n            'stage iva',\r\n            'stage ivb',\r\n            'stage ive',\r\n            'stage ivs'\r\n          ];\r\n          break;\r\n        case 'rai staging system':\r\n          codeList = [\r\n             'stage 0',\r\n             'stage i',\r\n             'stage ii',\r\n             'stage iii',\r\n             'stage iv'\r\n          ];\r\n          break;\r\n        case 'durie-salmon staging system':\r\n          codeList = [\r\n            'stage 1',\r\n            'stage 1a',\r\n            'stage 1b',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib'\r\n          ];\r\n          break;\r\n        case 'figo staging system':\r\n          codeList = [\r\n            'stage ia',\r\n            'stage ia1',\r\n            'stage ia2',\r\n            'stage ib',\r\n            'stage ib1',\r\n            'stage ib2',\r\n            'stage iia',\r\n            'stage iab',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iva',\r\n            'stage ivb'\r\n          ];\r\n          break;\r\n        case 'binet staging system':\r\n          codeList = [\r\n             'stage a',\r\n             'stage b',\r\n             'stage c'\r\n         ];\r\n          break;\r\n        case 'ajcc 8th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ia3','stage ib','stage ib1','stage ib2','stage ic','stage ie','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iie','stage iii','stage iiia','stage iiia1','stage iiia2','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iiid','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'];\r\n          break;\r\n        case 'ajcc 7th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ib','stage ib1','stage ib2','stage ic','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iii','stage iiia','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'\r\n];\r\n          break;\r\n        default:\r\n          codelist = [];\r\n      }\r\n\r\n      if (!codeList.includes($field.trim().toLowerCase()) && codeList.length) {\r\n        const msg = `'${$field}' is not a permissible value. When '${stagingSystem}' is set to '${\r\n          $row[stagingSystem]\r\n        }', '${stagingName}_stage_group' must be one of the following: \\n${codeList\r\n          .map(code => `- \"${code}\"`)\r\n          .join('\\n')}`;\r\n\r\n        result.valid = false;\r\n        result.message = msg;\r\n      }\r\n    }\r\n    \r\n    return result;\r\n  })"
              ]
            }
          }
        },
        "posttherapy_tumour_staging_system": {
          "restrictions": {
            "script": {
              "left": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const arrayFormatter = arr => `\\n${arr.map(entry => `- \"${entry}\"`).join('\\n')}`;\r\n    /* This is not a required field, so first ensure that it exists */\r\n    if ($field) {\r\n      /* Contingent on the naming system for tumour staging systems to remain consistent */\r\n      const stagingName = $name\r\n        .trim()\r\n        .toLowerCase()\r\n        .split('_tumour_staging_system')[0];\r\n      const requiredFields = [\r\n        `${stagingName}_m_category`,\r\n        `${stagingName}_n_category`,\r\n        `${stagingName}_t_category`,\r\n      ];\r\n      const convertedRow = Object.fromEntries(\r\n        Object.entries($row).map(([fieldName, fieldVal]) => [fieldName.toLowerCase(), fieldVal]),\r\n      );\r\n      /* Check for contigous spaces wrapped with quotes (empty strings) */\r\n      const checkforEmpty = entry => {\r\n        return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'));\r\n      };\r\n\r\n      /* search for fields with falsy values*/\r\n      const emptyFields = requiredFields.filter(\r\n        field => !convertedRow[field] || checkforEmpty(convertedRow[field]),\r\n      );\r\n\r\n      /* The fields should be provided IF and ONLY IF the AJCC regex passes */\r\n      if (/^(AJCC)\\b/i.test($field) && emptyFields.length) {\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields are required when ${$name} is set to an AJCC option: ${arrayFormatter(\r\n            emptyFields,\r\n          )}`,\r\n        };\r\n      } else if (!/^(AJCC)\\b/i.test($field) && emptyFields.length != requiredFields.length) {\r\n        const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields cannot be provided when ${$name} is not set to an AJCC option: ${arrayFormatter(\r\n            errorFields,\r\n          )}`,\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ],
              "right": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const arrayFormatter = arr => `\\n${arr.map(entry => `- \"${entry}\"`).join('\\n')}`;\r\n    const listFormatter = arr => `${arr.map(entry => `\"${entry}\"`).join(', ')}`;\r\n\r\n   \r\n   /* Contingent on the naming system for tumour staging systems to remain consistent */\r\n    const stagingName = $name\r\n      .trim()\r\n      .toLowerCase()\r\n      .split('_tumour_staging_system')[0];\r\n    const requiredFields = [\r\n      `${stagingName}_m_category`,\r\n      `${stagingName}_n_category`,\r\n      `${stagingName}_t_category`,\r\n    ];\r\n    const convertedRow = Object.fromEntries(\r\n      Object.entries($row).map(([fieldName, fieldVal]) => [fieldName.toLowerCase(), fieldVal]),\r\n    );\r\n    /* Check for contigous spaces wrapped with quotes (empty strings) */\r\n    const checkforEmpty = entry => {\r\n      return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'));\r\n    };\r\n\r\n    /* search for fields with falsy values*/\r\n    const emptyFields = requiredFields.filter(\r\n      field => !convertedRow[field] || checkforEmpty(convertedRow[field]),\r\n    );\r\n\r\n    /* The staging system should be set to an AJCC option if the TNM fields are submitted */\r\n    if (!($field) && emptyFields.length != requiredFields.length) {\r\n       const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n       result = {\r\n         valid: false,\r\n         message:`The ${stagingName}_tumour_staging_system field must be set to an AJCC option when the following fields are submitted: ${listFormatter(\r\n            errorFields,\r\n          )}`,\r\n       };\r\n    }\r\n    /* This is not a required field, so first ensure that it exists */\r\n    else if ($field) {\r\n      /* The fields should be provided IF and ONLY IF the AJCC regex passes */\r\n      if (/^(AJCC)\\b/i.test($field) && emptyFields.length) {\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields are required when ${$name} is set to an AJCC option: ${arrayFormatter(\r\n            emptyFields,\r\n          )}`,\r\n        };\r\n      } else if (!/^(AJCC)\\b/i.test($field) && emptyFields.length != requiredFields.length) {\r\n        const errorFields = requiredFields.filter(fieldName => !emptyFields.includes(fieldName));\r\n        result = {\r\n          valid: false,\r\n          message: `The following fields cannot be provided when ${$name} is not set to an AJCC option: ${arrayFormatter(\r\n            errorFields,\r\n          )}`,\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ]
            }
          }
        },
        "posttherapy_stage_group": {
          "restrictions": {
            "script": {
              "left": [
                "(function validate(inputs) {\r\n    const {$row, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    if ($row.posttherapy_tumour_staging_system && $field) {\r\n      let codeList = [];\r\n      switch ($row.posttherapy_tumour_staging_system && $row.posttherapy_tumour_staging_system.trim().toLowerCase()) {\r\n        case 'revised international staging system (riss)':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii'\r\n          ];\r\n          break;\r\n        case 'lugano staging system':\r\n          codeList = [\r\n             'stage i',\r\n             'stage ia',\r\n             'stage ib',\r\n             'stage ie',\r\n             'stage iea',\r\n             'stage ieb',\r\n             'stage ii',\r\n             'stage iia',\r\n             'stage iib',\r\n             'stage iie',\r\n             'stage iiea',\r\n             'stage iieb',\r\n             'stage iii',\r\n             'stage iiia',\r\n             'stage iiib',\r\n             'stage iv',\r\n             'stage iva',\r\n             'stage ivb'\r\n          ];\r\n          break;\r\n        case 'st jude staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii',\r\n            'stage iv'\r\n          ];\r\n          break;\r\n        case 'ann arbor staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ia',\r\n            'stage ib',\r\n            'stage ie',\r\n            'stage is',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iie',\r\n            'stage iis',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iiie',\r\n            'stage iiis',\r\n            'stage iv',\r\n            'stage iva',\r\n            'stage ivb',\r\n            'stage ive',\r\n            'stage ivs'\r\n          ];\r\n          break;\r\n        case 'rai staging system':\r\n          codeList = [\r\n             'stage 0',\r\n             'stage i',\r\n             'stage ii',\r\n             'stage iii',\r\n             'stage iv'\r\n          ];\r\n          break;\r\n        case 'durie-salmon staging system':\r\n          codeList = [\r\n            'stage 1',\r\n            'stage 1a',\r\n            'stage 1b',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib'\r\n          ];\r\n          break;\r\n        case 'figo staging system':\r\n          codeList = [\r\n            'stage ia',\r\n            'stage ia1',\r\n            'stage ia2',\r\n            'stage ib',\r\n            'stage ib1',\r\n            'stage ib2',\r\n            'stage iia',\r\n            'stage iab',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iva',\r\n            'stage ivb'\r\n          ];\r\n          break;\r\n        case 'binet staging system':\r\n          codeList = [\r\n             'stage a',\r\n             'stage b',\r\n             'stage c'\r\n         ];\r\n          break;\r\n        case 'ajcc 8th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ia3','stage ib','stage ib1','stage ib2','stage ic','stage ie','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iie','stage iii','stage iiia','stage iiia1','stage iiia2','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iiid','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'];\r\n          break;\r\n        case 'ajcc 7th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ib','stage ib1','stage ib2','stage ic','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iii','stage iiia','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'\r\n];\r\n          break;\r\n        default:\r\n          codelist = [];\r\n      }\r\n\r\n      if (!codeList.includes($field.trim().toLowerCase()) && codeList.length) {\r\n        const msg = `'${$field}' is not a permissible value. When 'posttherapy_tumour_staging_system' is set to '${\r\n          $row.posttherapy_tumour_staging_system\r\n        }', 'posttherapy_stage_group' must be one of the following: \\n${codeList\r\n          .map(code => `- \"${code}\"`)\r\n          .join('\\n')}`;\r\n\r\n        result.valid = false;\r\n        result.message = msg;\r\n      }\r\n    }\r\n    return result;\r\n  })"
              ],
              "right": [
                "(function validate(inputs) {\r\n    const {$row, $name, $field} = inputs;\r\n    let result = { valid: true, message: 'Ok' };\r\n    const stagingName = $name\r\n      .trim()\r\n      .toLowerCase()\r\n      .split('_stage_group')[0];\r\n\r\n    const stagingSystem = stagingName + `_tumour_staging_system`;\r\n    \r\n    // checks for a string just consisting of whitespace\r\n    const checkforEmpty = (entry) => {return /^\\s+$/g.test(decodeURI(entry).replace(/^\"(.*)\"$/, '$1'))};\r\n \r\n    if ($row[stagingSystem] && (!$field || checkforEmpty($field))) {\r\n      result.valid = false;\r\n      const msg = `The ${stagingName}_stage_group must be submitted if the field ${stagingSystem} is submitted.`;\r\n      result.message = msg;\r\n    }\r\n    else if (!($row[stagingSystem]) && $field) {\r\n       result.valid = false;\r\n       const msg = `The field ${stagingSystem} must be submitted if ${stagingName}_stage_group is submitted.`;\r\n       result.message = msg;\r\n    }\r\n    else if ($row[stagingSystem] && $field) {\r\n      let codeList = [];\r\n      switch ($row[stagingSystem] && $row[stagingSystem].trim().toLowerCase()) {\r\n        case 'revised international staging system (riss)':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii'\r\n          ];\r\n          break;\r\n        case 'lugano staging system':\r\n          codeList = [\r\n             'stage i',\r\n             'stage ia',\r\n             'stage ib',\r\n             'stage ie',\r\n             'stage iea',\r\n             'stage ieb',\r\n             'stage ii',\r\n             'stage iia',\r\n             'stage iib',\r\n             'stage iie',\r\n             'stage iiea',\r\n             'stage iieb',\r\n             'stage iii',\r\n             'stage iiia',\r\n             'stage iiib',\r\n             'stage iv',\r\n             'stage iva',\r\n             'stage ivb'\r\n          ];\r\n          break;\r\n        case 'st jude staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ii',\r\n            'stage iii',\r\n            'stage iv'\r\n          ];\r\n          break;\r\n        case 'ann arbor staging system':\r\n          codeList = [\r\n            'stage i',\r\n            'stage ia',\r\n            'stage ib',\r\n            'stage ie',\r\n            'stage is',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iie',\r\n            'stage iis',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iiie',\r\n            'stage iiis',\r\n            'stage iv',\r\n            'stage iva',\r\n            'stage ivb',\r\n            'stage ive',\r\n            'stage ivs'\r\n          ];\r\n          break;\r\n        case 'rai staging system':\r\n          codeList = [\r\n             'stage 0',\r\n             'stage i',\r\n             'stage ii',\r\n             'stage iii',\r\n             'stage iv'\r\n          ];\r\n          break;\r\n        case 'durie-salmon staging system':\r\n          codeList = [\r\n            'stage 1',\r\n            'stage 1a',\r\n            'stage 1b',\r\n            'stage ii',\r\n            'stage iia',\r\n            'stage iib',\r\n            'stage iii',\r\n            'stage iiia',\r\n            'stage iiib'\r\n          ];\r\n          break;\r\n        case 'figo staging system':\r\n          codeList = [\r\n            'stage ia',\r\n            'stage ia1',\r\n            'stage ia2',\r\n            'stage ib',\r\n            'stage ib1',\r\n            'stage ib2',\r\n            'stage iia',\r\n            'stage iab',\r\n            'stage iiia',\r\n            'stage iiib',\r\n            'stage iva',\r\n            'stage ivb'\r\n          ];\r\n          break;\r\n        case 'binet staging system':\r\n          codeList = [\r\n             'stage a',\r\n             'stage b',\r\n             'stage c'\r\n         ];\r\n          break;\r\n        case 'ajcc 8th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ia3','stage ib','stage ib1','stage ib2','stage ic','stage ie','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iie','stage iii','stage iiia','stage iiia1','stage iiia2','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iiid','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'];\r\n          break;\r\n        case 'ajcc 7th edition':\r\n          codeList = ['stage 0','stage 0a','stage 0is','stage i','stage ia','stage ia1','stage ia2','stage ib','stage ib1','stage ib2','stage ic','stage is','stage ii','stage iia','stage iia1','stage iia2','stage iib','stage iic','stage iii','stage iiia','stage iiib','stage iiic','stage iiic1','stage iiic2','stage iv','stage iva','stage iva1','stage iva2','stage ivb','stage ivc','occult carcinoma','stage 1'\r\n];\r\n          break;\r\n        default:\r\n          codelist = [];\r\n      }\r\n\r\n      if (!codeList.includes($field.trim().toLowerCase()) && codeList.length) {\r\n        const msg = `'${$field}' is not a permissible value. When '${stagingSystem}' is set to '${\r\n          $row[stagingSystem]\r\n        }', '${stagingName}_stage_group' must be one of the following: \\n${codeList\r\n          .map(code => `- \"${code}\"`)\r\n          .join('\\n')}`;\r\n\r\n        result.valid = false;\r\n        result.message = msg;\r\n      }\r\n    }\r\n    \r\n    return result;\r\n  })"
              ]
            }
          }
        }
      },
      "created": {},
      "deleted": {}
    }
  }
}
